# 中国政府采购网公告爬虫

## 📋 项目概述
本项目是一个用于自动抓取中国政府采购网 (`http://www.ccgp.gov.cn`) 招标公告数据的 Python 爬虫程序。提供直观的图形界面，支持自定义搜索条件，并将结果导出为 Excel 文件，方便数据分析和归档。

## ✨ 主要功能
- 🖥️ **图形界面操作**: 直观的 PyQt6 界面，无需命令行操作
- 🔍 **灵活搜索条件**: 支持关键词、采购人、代理机构、公告类型、区域等多维度搜索
- 📅 **时间范围选择**: 提供预设时间范围（今天、3天、1周、1月等）和自定义时间选择
- 📊 **Excel 导出**: 将抓取结果导出为格式化的 Excel 文件
- 📁 **自定义保存路径**: 支持选择数据保存目录
- ⏸️ **中断保护**: 支持随时停止抓取并保存已获取的数据
- 🎯 **实时进度显示**: 显示抓取进度和详细日志信息
- 🔄 **自动保存**: 抓取完成后可自动保存结果

## 📊 Excel 导出格式
导出的 Excel 文件包含以下列：
- A列：序号
- B列：关键字（显示搜索使用的关键词）
- C列：名称（公告标题）
- D列：日期（发布日期）
- E列：采购人
- F列：代理机构
- G列：公告类型
- H列：详情（链接地址）
- I列：项目概况

## 🛠️ 环境要求
- Python 3.8+
- 依赖库：见 `requirements.txt` 文件
- Windows 用户需要安装 Microsoft Visual C++ Redistributable

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

必需的依赖包：
- `PyQt6==6.4.0` - 图形界面框架
- `requests==2.31.0` - HTTP 请求库
- `lxml==4.9.3` - HTML 解析库  
- `xlsxwriter==3.1.2` - Excel 文件生成库

### 2. 运行程序
```bash
python Crawler_GUI_V2.py
```

### 3. 使用说明

#### 界面介绍
程序提供两个主要标签页：

**爬虫设置页面：**
- **搜索参数区域**：
  - 关键词：搜索的关键字（如"公告"、"招标"等）
  - 采购人：指定采购单位名称（可选）
  - 代理机构：指定代理机构名称（可选）
  - 公告类型：选择公告类型（所有、公开招标、中标公告等）
  - 区域：选择地区范围
  - 时间预设：快速选择时间范围
  - 自定义时间：手动设置起止日期

- **输出设置区域**：
  - 保存路径：选择文件保存目录
  - 输出文件前缀：设置输出文件名前缀

- **操作按钮**：
  - 🚀 开始抓取：启动数据抓取
  - ⏹️ 停止：中止当前抓取任务
  - 💾 保存结果：手动保存抓取结果

**高级设置页面：**
- 请求延迟：设置请求间隔时间（2-6秒）
- 自动保存：抓取完成后自动保存结果

#### 操作流程
1. 设置搜索条件（关键词、时间范围、区域等）
2. 选择保存路径和文件名前缀
3. 点击"开始抓取"按钮
4. 查看实时日志和进度信息
5. 抓取完成后自动保存或手动保存结果

## 📝 搜索参数说明

### 时间预设选项
- **今天**：当天发布的公告
- **三天内**：最近3天的公告
- **一周内**：最近7天的公告
- **半月内**：最近14天的公告
- **一月内**：最近30天的公告
- **三月内**：最近90天的公告
- **半年内**：最近180天的公告
- **一年内**：最近365天的公告

### 公告类型选项
- 所有：不限制公告类型
- 公开招标：公开招标公告
- 询价公告：询价采购公告
- 竞争性谈判：竞争性谈判公告
- 单一来源：单一来源采购公告
- 资格预审：资格预审公告
- 邀请公告：邀请招标公告
- 中标公告：中标结果公告
- 更正公告：更正/补充公告
- 其他公告：其他类型公告
- 竞争性磋商：竞争性磋商公告
- 成交公告：成交结果公告
- 废标公告：废标公告

### 区域选择
支持全国各省市自治区，包括：
北京、天津、河北、山西、内蒙古、辽宁、吉林、黑龙江、上海、江苏、浙江、安徽、福建、江西、山东、河南、湖北、湖南、广东、广西、海南、重庆、四川、贵州、云南、西藏、陕西、甘肃、青海、宁夏、新疆

## 🔧 技术实现
- **框架**：PyQt6 图形界面框架
- **网络请求**：requests 库发送 HTTP 请求
- **数据解析**：lxml 库解析 HTML 内容
- **Excel 导出**：xlsxwriter 库生成 Excel 文件
- **多线程**：使用 QThread 实现后台数据抓取，避免界面冻结
- **配置管理**：JSON 格式保存用户配置

## ⚠️ 注意事项
1. **合规使用**：仅供学习研究使用，请遵守网站使用协议
2. **频率控制**：程序内置随机延迟（2-6秒），避免频繁请求
3. **网络环境**：确保网络连接稳定，避免抓取过程中断
4. **数据准确性**：数据来源于政府采购网，请以官方发布为准

## 🐛 常见问题

### Q: 程序启动时提示缺少模块
**A**: 请确保已安装所有依赖：
```bash
pip install requests lxml xlsxwriter PyQt6
```

### Q: 抓取数据为空
**A**: 检查搜索条件设置，可能该时间段内没有匹配的公告，或者网络连接问题。

### Q: 程序界面无响应
**A**: 数据抓取在后台进行，请查看日志区域的进度信息，等待抓取完成。

### Q: Excel文件无法打开
**A**: 确保保存路径存在且有写入权限，检查文件名是否包含特殊字符。

### Q: 网络请求失败
**A**: 检查网络连接，或稍后重试。程序会自动重试失败的请求。

## 📁 项目结构
```
CrawlerForCCGP/
├── Crawler_GUI_V2.py      # 主程序文件
├── requirements.txt        # 依赖包列表
├── config.json            # 配置文件（自动生成）
└── readme.md              # 项目说明文档
```

## 📄 免责声明
本程序仅供个人学习、研究和技术实验使用。使用者应确保符合目标网站的使用条款及相关法律法规，开发者不承担因使用本程序产生的任何法律责任。

## 🔗 相关链接
- [中国政府采购网](http://www.ccgp.gov.cn/)
- [PyQt6 官方文档](https://www.riverbankcomputing.com/static/Docs/PyQt6/)

---

**版本信息**: v2.0  
**更新日期**: 2025-07-09  
**Python版本**: 3.8+